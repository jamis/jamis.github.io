(function(){var d,b,a={}.hasOwnProperty,c=function(h,f){for(var e in f){if(a.call(f,e)){h[e]=f[e]}}function g(){this.constructor=h}g.prototype=f.prototype;h.prototype=new g();h.__super__=f.prototype;return h};b=(function(){e.prototype.N=624;e.prototype.M=397;e.prototype.MATRIX_A=2567483615;e.prototype.UPPER_MASK=2147483648;e.prototype.LOWER_MASK=2147483647;function e(f){this.mt=new Array(this.N);this.setSeed(f)}e.prototype.unsigned32=function(f){if(f<0){return(f^this.UPPER_MASK)+this.UPPER_MASK}else{return f}};e.prototype.subtraction32=function(g,f){if(g<f){return this.unsigned32((4294967296-(f-g))%4294967295)}else{return g-f}};e.prototype.addition32=function(g,f){return this.unsigned32((g+f)&4294967295)};e.prototype.multiplication32=function(j,g){var f,h,k;h=0;for(f=k=0;k<32;f=++k){if((j>>>f)&1){h=this.addition32(h,this.unsigned32(g<<f))}}return h};e.prototype.setSeed=function(f){if(!f||typeof f==="number"){return this.seedWithInteger(f)}else{return this.seedWithArray(f)}};e.prototype.defaultSeed=function(){var f;f=new Date();return f.getMinutes()*60000+f.getSeconds()*1000+f.getMilliseconds()};e.prototype.seedWithInteger=function(g){var f;this.seed=g!=null?g:this.defaultSeed();this.mt[0]=this.unsigned32(this.seed&4294967295);this.mti=1;f=[];while(this.mti<this.N){this.mt[this.mti]=this.addition32(this.multiplication32(1812433253,this.unsigned32(this.mt[this.mti-1]^(this.mt[this.mti-1]>>>30))),this.mti);this.mti[this.mti]=this.unsigned32(this.mt[this.mti]&4294967295);f.push(this.mti++)}return f};e.prototype.seedWithArray=function(m){var l,h,f,g;this.seedWithInteger(19650218);l=1;h=0;f=this.N>m.length?this.N:m.length;while(f>0){g=this.multiplication32(this.unsigned32(this.mt[l-1]^(this.mt[l-1]>>>30)),1664525);this.mt[l]=this.addition32(this.addition32(this.unsigned32(this.mt[l]^g),m[h]),h);this.mt[l]=this.unsigned32(this.mt[l]&4294967295);l++;h++;if(l>=this.N){this.mt[0]=this.mt[this.N-1];l=1}if(h>=m.length){h=0}f--}f=this.N-1;while(f>0){this.mt[l]=this.subtraction32(this.unsigned32(this.mt[l]^this.multiplication32(this.unsigned32(this.mt[l-1]^(this.mt[l-1]>>>30)),1566083941)),l);this.mt[l]=this.unsigned32(this.mt[l]&4294967295);l++;if(l>=this.N){this.mt[0]=this.mt[this.N-1];l=1}}return this.mt[0]=2147483648};e.prototype.nextInteger=function(f){var g,h,i;if((f!=null?f:1)<1){return 0}h=[0,this.MATRIX_A];if(this.mti>=this.N){g=0;while(g<this.N-this.M){i=this.unsigned32((this.mt[g]&this.UPPER_MASK)|(this.mt[g+1]&this.LOWER_MASK));this.mt[g]=this.unsigned32(this.mt[g+this.M]^(i>>>1)^h[i&1]);g++}while(g<this.N-1){i=this.unsigned32((this.mt[g]&this.UPPER_MASK)|(this.mt[g+1]&this.LOWER_MASK));this.mt[g]=this.unsigned32(this.mt[g+this.M-this.N]^(i>>>1)^h[i&1]);g++}i=this.unsigned32((this.mt[this.N-1]&this.UPPER_MASK)|(this.mt[0]&this.LOWER_MASK));this.mt[this.N-1]=this.unsigned32(this.mt[this.M-1]^(i>>>1)^h[i&1]);this.mti=0}i=this.mt[this.mti++];i=this.unsigned32(i^(i>>>11));i=this.unsigned32(i^((i<<7)&2636928640));i=this.unsigned32(i^((i<<15)&4022730752));return this.unsigned32(i^(i>>>18))%(f!=null?f:4294967296)};e.prototype.nextFloat=function(){return this.nextInteger()/4294967295};e.prototype.nextBoolean=function(){return this.nextInteger()%2===0};return e})();d=(function(){e.prototype.N=1<<0;e.prototype.S=1<<1;e.prototype.E=1<<2;e.prototype.W=1<<3;function e(i,g,h){var f,j;this.width=i;this.height=g;if(h==null){h={}}this.grid=(function(){var m,l,k;k=[];for(j=m=1,l=this.height;1<=l?m<=l:m>=l;j=1<=l?++m:--m){k.push((function(){var p,n,o;o=[];for(f=p=1,n=this.width;1<=n?p<=n:p>=n;f=1<=n?++p:--p){o.push(0)}return o}).call(this))}return k}).call(this);this.rand=new b(h.seed);this.rand.randomElement=function(k){return k[this.nextInteger(k.length)]};this.rand.shuffleList=function(n){var l,k,m;l=n.length-1;while(l>0){k=this.nextInteger(l+1);m=[n[k],n[l]],n[l]=m[0],n[k]=m[1];l--}return n};this.generate()}e.prototype.mark=function(h,g,f){return this.grid[g][h]|=f};e.prototype.unmark=function(h,g,f){return this.grid[g][h]&=~f};e.prototype.isMarked=function(f,h,g){return(this.grid[g][h]&f)===f};e.prototype.utilities=function(){var f;return f={dx:(function(g){return function(h){switch(h){case g.N:case g.S:return 0;case g.E:return 1;case g.W:return -1}}})(this),dy:(function(g){return function(h){switch(h){case g.E:case g.W:return 0;case g.N:return -1;case g.S:return 1}}})(this),opposite:(function(g){return function(h){switch(h){case g.W:return g.E;case g.E:return g.W;case g.N:return g.S;case g.S:return g.N}}})(this),directions:[this.N,this.S,this.E,this.W]}};e.prototype.generate=function(){var v,t,r,q,s,m,z,w,u,l,p,n,i,A,o,k,j,h,f,g;o=this.utilities(),r=o.dx,q=o.dy,u=o.opposite,t=o.directions;l=[[this.rand.nextInteger(this.width),this.rand.nextInteger(this.height)]];g=[];while(l.length>0){m=this.rand.nextBoolean()?this.rand.nextInteger(l.length):l.length-1;k=l[m],p=k[0],n=k[1];s=false;j=this.rand.shuffleList(t.slice(0));for(i=0,A=j.length;i<A;i++){v=j[i];h=[p+r(v),n+q(v)],z=h[0],w=h[1];if((0<=z&&z<this.width)&&(0<=w&&w<this.height)&&this.grid[w][z]===0){s=true;this.grid[n][p]|=v;this.grid[w][z]|=u(v);l.push([z,w]);break}}if(!s){g.push(([].splice.apply(l,[m,m-m+1].concat(f=[])),f))}else{g.push(void 0)}}return g};e.prototype.thin=function(n){var r,f,o,t,s,m,k,l,q,p,i,j,h,g;j=this.utilities(),t=j.dx,s=j.dy,l=j.opposite,o=j.directions;g=[];for(p=i=0,h=this.height-1;0<=h?i<=h:i>=h;p=0<=h?++i:--i){g.push((function(){var v,w,u;u=[];for(q=v=0,w=this.width-1;0<=w?v<=w:v>=w;q=0<=w?++v:--v){r=this.grid[p][q];if(r===this.N||r===this.S||r===this.E||r===this.W){if(this.rand.nextInteger(100)<n){u.push((function(){var z,x,B,A,y;B=this.rand.shuffleList(o.slice(0));y=[];for(z=0,x=B.length;z<x;z++){f=B[z];if(r===f){continue}A=[q+t(f),p+s(f)],m=A[0],k=A[1];if((0<=m&&m<this.width)&&(0<=k&&k<this.height)){this.grid[p][q]|=f;this.grid[k][m]|=l(f);break}else{y.push(void 0)}}return y}).call(this))}else{u.push(void 0)}}else{u.push(void 0)}}return u}).call(this))}return g};e.prototype.findDistances=function(w,v){var z,t,k,l,s,r,m,n,C,f,B,A,u,q,p,h,g,D,E,o,j,i;o=this.utilities(),s=o.dx,r=o.dy,u=o.opposite,t=o.directions;n=[[w,v]];l=(function(){var F,x,y;y=[];for(p=F=1,x=this.height;1<=x?F<=x:F>=x;p=1<=x?++F:--F){y.push((function(){var H,I,G;G=[];for(q=H=1,I=this.width;1<=I?H<=I:H>=I;q=1<=I?++H:--H){G.push(void 0)}return G}).call(this))}return y}).call(this);l[v][w]=0;C=0;m=null;while(n.length>0){f=[];for(h=0,D=n.length;h<D;h++){j=n[h],q=j[0],p=j[1];k=l[p][q];for(g=0,E=t.length;g<E;g++){z=t[g];if(this.isMarked(z,q,p)){i=[q+s(z),p+r(z)],B=i[0],A=i[1];if(l[A][B]==null){if(k+1>C){C=k+1;m=[B,A]}l[A][B]=k+1;f.push([B,A])}}}}n=f}return[l,C,m]};e.prototype.findMostDistantPoints=function(){var m,o,n,l,k,j,i,h,g,f;i=this.findDistances(0,0),m=i[0],l=i[1],(h=i[2],k=h[0],j=h[1]);g=this.findDistances(k,j),m=g[0],l=g[1],(f=g[2],o=f[0],n=f[1]);return[l,k,j,o,n]};e.prototype.findPathBetween=function(C,B,i,f){var F,u,o,t,s,A,z,g,E,D,v,w,r,q,l,G,p,n,m,k,j,h;p=this.findDistances(C,B),o=p[0],g=p[1],(n=p[2],A=n[0],z=n[1]);m=this.utilities(),t=m.dx,s=m.dy,v=m.opposite,u=m.directions;w=[[i,f]];k=[i,f],r=k[0],q=k[1];while(!(r===C&&q===B)){for(l=0,G=u.length;l<G;l++){F=u[l];if(!this.isMarked(F,r,q)){continue}j=[r+t(F),q+s(F)],E=j[0],D=j[1];if(o[D][E]===o[q][r]-1){w.push([E,D]);h=[E,D],r=h[0],q=h[1]}}}return[C,B,i,f,w]};e.prototype.findLongestPath=function(){var m,o,n,l,k,j,i,h,g,f;i=this.findDistances(0,0),m=i[0],l=i[1],(h=i[2],k=h[0],j=h[1]);g=this.findDistances(k,j),m=g[0],l=g[1],(f=g[2],o=f[0],n=f[1]);return this.findPathBetween(k,j,o,n)};return e})();window.RenderedMaze=(function(){function e(j,h,f,g,i){this.canvas=document.getElementById(j);this.maze=new d(h,f,g);if(typeof i==="function"){i(this.maze)}this.displayedWidth=this.canvas.width;this.displayedHeight=this.canvas.height;this.displayedOriginX=0;this.displayedOriginY=0;this.recomputeMetrics()}e.prototype.recomputeMetrics=function(){var o,h,p,g,f,l,n,m,j,k,i;this.dx=this.displayedWidth/this.maze.width;this.dy=this.displayedHeight/this.maze.height;if((this.startX!=null)&&(this.startY!=null)){this.startCell=[Math.round(this.startX*this.dx)+2,Math.round(this.startY*this.dy)+2,Math.round(this.dx)-5,Math.round(this.dy)-5]}if((this.endX!=null)&&(this.endY!=null)){this.endCell=[Math.round(this.endX*this.dx)+2,Math.round(this.endY*this.dy)+2,Math.round(this.dx)-5,Math.round(this.dy)-5]}h=Math.round(this.maze.width*this.dx);o=Math.round(this.maze.height*this.dx);this.walls=[];this.walls.push([0,0,h,0]);this.walls.push([0,0,0,o]);this.walls.push([0,o,h,o]);this.walls.push([h,0,h,o]);i=[];for(l=j=0,k=this.maze.height-1;0<=k?j<=k:j>=k;l=0<=k?++j:--j){i.push((function(){var s,q,r;r=[];for(p=s=0,q=this.maze.width-1;0<=q?s<=q:s>=q;p=0<=q?++s:--s){g=Math.round(p*this.dx);n=Math.round(l*this.dy);f=Math.round((p+1)*this.dx);m=Math.round((l+1)*this.dy);if(p+1<this.maze.width&&!this.maze.isMarked(this.maze.E,p,l)){this.walls.push([f,n,f,m])}if(l+1<this.maze.height&&!this.maze.isMarked(this.maze.S,p,l)){r.push(this.walls.push([g,m,f,m]))}else{r.push(void 0)}}return r}).call(this))}return i};e.prototype.renderBackground=function(f){};e.prototype.clear=function(){return this.canvas.width=this.canvas.width};e.prototype.renderInBounds=function(j,i,g,q,h){var n,p,o,f,m,l,k;m=[this.displayedWidth,this.displayedHeight,this.displayedOriginX,this.displayedOriginY],f=m[0],n=m[1],p=m[2],o=m[3];l=[g,q,j,i],this.displayedWidth=l[0],this.displayedHeight=l[1],this.displayedOriginX=l[2],this.displayedOriginY=l[3];this.recomputeMetrics();this.render(h);k=[f,n,p,o],this.displayedWidth=k[0],this.displayedHeight=k[1],this.displayedOriginX=k[2],this.displayedOriginY=k[3];return this.recomputeMetrics()};e.prototype.rerender=function(){this.clear();return this.render()};e.prototype.render=function(g){var q,j,i,h,f,p,n,l,o,m,k;q=this.canvas.getContext("2d");this.renderBackground(q,g);j=this.displayedOriginX;i=this.displayedOriginY;if(this.startCell!=null){q.fillStyle="red";q.fillRect(j+this.startCell[0],i+this.startCell[1],this.startCell[2],this.startCell[3])}if(this.endCell!=null){q.fillStyle="green";q.fillRect(j+this.endCell[0],i+this.endCell[1],this.endCell[2],this.endCell[3])}q.beginPath();m=this.walls;for(l=0,o=m.length;l<o;l++){k=m[l],h=k[0],p=k[1],f=k[2],n=k[3];q.moveTo(j+h,i+p);q.lineTo(j+f,i+n)}return q.stroke()};return e})();window.BinaryHeap=(function(){function e(f){this.higher=f;this.list=[]}e.prototype.insert=function(h){var i,f,g;this.list.push(h);i=this.list.length-1;while(i>0){f=Math.floor((i-1)/2);if(this.higher(this.list[i],this.list[f])){g=[this.list[f],this.list[i]],this.list[i]=g[0],this.list[f]=g[1];i=f}else{break}}return this};e.prototype.buildHeap=function(f){this.list=f.slice();return this.reheapify()};e.prototype.isEmpty=function(){return this.list.length===0};e.prototype.peek=function(){return this.list[0]};e.prototype["delete"]=function(){var f,g;g=this.list[0];f=this.list.pop();if(this.list.length>0){this.list[0]=f;this.heapifyFrom(0)}return g};e.prototype.reheapify=function(){var g,f,h;f=(this.list.length-2)/2;for(g=h=f;f<=0?h<=0:h>=0;g=f<=0?++h:--h){this.heapifyFrom(g)}return this};e.prototype.heapifyFrom=function(f){var j,i,g,h;i=f*2+1;g=f*2+2;j=f;if(g<this.list.length&&this.higher(this.list[g],this.list[f])&&this.higher(this.list[g],this.list[i])){j=g}else{if(i<this.list.length&&this.higher(this.list[i],this.list[f])){j=i}}if(j!==f){h=[this.list[j],this.list[f]],this.list[f]=h[0],this.list[j]=h[1];return this.heapifyFrom(j)}};return e})();window.ParallelSearches=(function(i){var e,j,h,f;c(g,i);f=(function(){k.prototype.PENDING=4096;k.prototype.VISITED=8192;function k(p,m,l,o,n){this.maze=p;this.startX=m;this.startY=l;this.endX=o;this.endY=n;this.resetState()}k.prototype.resetState=function(){var l,m;this.grid=(function(){var p,o,n;n=[];for(m=p=1,o=this.maze.height;1<=o?p<=o:p>=o;m=1<=o?++p:--p){n.push((function(){var s,q,r;r=[];for(l=s=1,q=this.maze.width;1<=q?s<=q:s>=q;l=1<=q?++s:--s){r.push(0)}return r}).call(this))}return n}).call(this);this.heap=new BinaryHeap((function(n){return function(p,o){return n.compareNodes(p,o)}})(this));this.tail=[this.startX,this.startY,null,0];this.heap.insert(this.tail);return this.finished=false};k.prototype.isVisited=function(l,m){return(this.grid[m][l]&this.VISITED)===this.VISITED};k.prototype.compareNodes=function(m,l){};k.prototype.step=function(){var m,v,D,C,l,u,s,t,B,A,w,q,z,r,p,n,o;if(this.finished||this.heap.isEmpty()){return false}r=this.maze.utilities(),D=r.dx,C=r.dy,t=r.opposite,v=r.directions;p=this.tail=this.heap["delete"](),A=p[0],w=p[1],B=p[2],l=p[3];this.grid[w][A]|=this.VISITED;if(A===this.endX&&w===this.endY){return this.finished=new Date().getTime()}else{o=[];for(q=0,z=v.length;q<z;q++){m=v[q];if(this.maze.isMarked(m,A,w)){n=[A+D(m),w+C(m)],u=n[0],s=n[1];if((this.grid[s][u]&this.PENDING)===0){this.heap.insert([u,s,this.tail,l+1]);o.push(this.grid[s][u]|=this.PENDING)}else{o.push(void 0)}}else{o.push(void 0)}}return o}};k.prototype.elapsed=function(){var l;if(this.started!=null){l=this.finished||new Date().getTime();return l-this.started}else{return 0}};return k})();j=(function(k){c(l,k);function l(){return l.__super__.constructor.apply(this,arguments)}l.prototype.compareNodes=function(n,m){return n[3]<=m[3]};return l})(f);h=(function(l){c(k,l);function k(){return k.__super__.constructor.apply(this,arguments)}k.prototype.compareNodes=function(n,m){var p,o;p=Math.abs(n[0]-this.endX)+Math.abs(n[1]-this.endY);o=Math.abs(m[0]-this.endX)+Math.abs(m[1]-this.endY);return p<=o};return k})(f);e=(function(l){c(k,l);function k(){return k.__super__.constructor.apply(this,arguments)}k.prototype.compareNodes=function(n,m){var p,o;p=Math.abs(n[0]-this.endX)+Math.abs(n[1]-this.endY)+n[3];o=Math.abs(m[0]-this.endX)+Math.abs(m[1]-this.endY)+m[3];return p<=o};return k})(f);function g(n,m,k,l){g.__super__.constructor.call(this,n,m,k,{seed:l},(function(o){return function(r){var p,q;o.maze.thin(25);o.startX=o.maze.rand.nextInteger(Math.floor(m/2));o.startY=o.maze.rand.nextInteger(Math.floor(k/2));o.endX=Math.floor(m/2)+o.maze.rand.nextInteger(Math.floor(m/2));o.endY=Math.floor(k/2)+o.maze.rand.nextInteger(Math.floor(k/2));return q=o.maze.findPathBetween(o.startX,o.startY,o.endX,o.endY),p=q[0],p=q[1],p=q[2],p=q[3],o.shortest=q[4],q}})(this));this.resetState()}g.prototype.resetState=function(){this.dijkstra=new j(this.maze,this.startX,this.startY,this.endX,this.endY);this.greedy=new h(this.maze,this.startX,this.startY,this.endX,this.endY);return this.astar=new e(this.maze,this.startX,this.startY,this.endX,this.endY)};g.prototype.stop=function(){if(this.timer!=null){window.clearInterval(this.timer);return delete this.timer}};g.prototype.reset=function(){this.stop();this.resetState();return this.render()};g.prototype.run=function(k){if(this.timer==null){this.dijkstra.started=this.greedy.started=this.astar.started=new Date().getTime();return this.timer=window.setInterval(((function(l){return function(){return l.runStep()}})(this)),k!=null?k:50)}};g.prototype.runStep=function(){if(!this.update()){window.clearInterval(this.timer);return delete this.timer}};g.prototype.update=function(){var k;k=false;k=this.dijkstra.step()||k;k=this.greedy.step()||k;k=this.astar.step()||k;if(k){this.renderAll()}return k};g.prototype.renderAll=function(){var r,m,w,u,v,q,k,o,t,l,p,s,n;this.clear();l=Math.floor(this.canvas.width/2);v=Math.floor(this.canvas.height/2);m=[{name:"Dijkstra",impl:this.dijkstra,ox:0,oy:0,w:l,h:v,bg:"rgb(255,200,200)",path:"rgb(200,50,50)"},{name:"Greedy",impl:this.greedy,ox:l,oy:0,w:l,h:v,bg:"rgb(200,255,200)",path:"rgb(50,200,50)"},{name:"A*",impl:this.astar,ox:0,oy:v,w:l,h:v,bg:"rgb(200,200,255)",path:"rgb(50,50,200)"}];w=this.canvas.getContext("2d");n=[];for(q=p=0,s=m.length;p<s;q=++p){r=m[q];this.renderInBounds(r.ox,r.oy,r.w,r.h,r);w.beginPath();w.fillStyle=r.path;w.font="bold 20px sans-serif";w.fillText(""+r.name+": "+r.impl.tail[3],l+25,v+36+q*56);u=r.impl.elapsed();o=Math.floor(u/60000);t=Math.floor((u%60000)/1000);k=u%1000;if(o.toString().length<2){o="0"+o}if(t.toString().length<2){t="0"+t}while(k.toString().length<3){k="0"+k}w.font="20px sans-serif";n.push(w.fillText(""+o+":"+t+"."+k,l+60,v+36+q*56+28))}return n};g.prototype.renderBackground=function(z,t){var k,m,w,l,u,v,r,q,s,p,n,o;g.__super__.renderBackground.call(this,z);z.fillStyle=t.bg;for(u=r=0,s=this.maze.height-1;0<=s?r<=s:r>=s;u=0<=s?++r:--r){for(w=q=0,p=this.maze.width-1;0<=p?q<=p:q>=p;w=0<=p?++q:--q){if(!t.impl.isVisited(w,u)){continue}l=this.displayedOriginX+Math.round(w*this.dx);v=this.displayedOriginY+Math.round(u*this.dy);z.fillRect(l,v,Math.ceil(this.dx),Math.ceil(this.dy))}}m=t.impl.tail;z.fillStyle=t.path;o=[];while(m){n=m,w=n[0],u=n[1],m=n[2],k=n[3];l=this.displayedOriginX+Math.round(w*this.dx);v=this.displayedOriginY+Math.round(u*this.dy);o.push(z.fillRect(l,v,Math.ceil(this.dx),Math.ceil(this.dy)))}return o};return g})(RenderedMaze);window.generateSearches=function(j,g,e){var f,h,i;f=document.getElementById(j);if((i=f.searches)!=null){i.stop()}h=new ParallelSearches(j,g,g,e);h.renderAll();f.searches=h};window.resetSearches=function(g){var e,f;e=document.getElementById(g);if((f=e.searches)!=null){f.reset()}};window.updateSearches=function(g){var e,f;e=document.getElementById(g);if((f=e.searches)!=null){f.update()}};window.runSearches=function(h,f){var e,g;e=document.getElementById(h);if((g=e.searches)!=null){g.run(f)}}}).call(this);